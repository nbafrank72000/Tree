<% provide(:title, 'Profile') %>

<div class = "user_edit_page">

	<%= render 'shared/aside' %>

	<div class = "col-md-8 user_edit">
		<% if current_user?(@user) %>
			<div class = "topic">Edit my profile</div>
		<% else %>
			<div class = "topic"><%= @user.name %>'s profile</div>
		<% end %>

		<div class = "edit_form">
			<%= form_for(@user) do |f| %>
				<%= render 'shared/error_messages', object: f.object %>

				<div id = "headpic_blk"><%= image_tag(@user.headpic.url) %></div>
				<%= f.file_field :headpic, id: 'headpic_prev', value: "change your photo", class: "headpic_update" %>

				<%= f.label :name %>
				<%= f.text_field :name, class: 'form-control' %>

				<%= f.label :email %>
				<%= f.email_field :email, class: 'form-control' %>

				<%= f.label :password %>
				<%= f.password_field :password, class: 'form-control' %>

				<%= f.label :password_confirmation, "Confirmation" %>
				<%= f.password_field :password_confirmation, class: 'form-control' %>

				<%= f.submit "Update your profile", class: "btn btn-primary btn-blue" %>
			<% end %>
		</div>
	</div>

</div>

<script type="text/javascript">
$(function(){
	$('#headpic_prev').on('change', function(event){
		var files = event.target.files;
		var image = files[0];
		console.log('image size:')
		console.log(image.size)

		var reader = new FileReader()
		reader.onload = function(file){
			var img = new Image();
			console.log('file info')
			console.log(file);
			img.src = file.target.result;
			$('#headpic_blk').html(img);
		}

		reader.readAsDataURL(image);
		console.log('files info')
		console.log(files)
	})
})
</script>